
這段程式碼的邏輯是基於 **線性常係數齊次常微分方程 (LCCDE)** 的標準解析理論，並針對計算機數值誤差做了優化。

#### 1. 數值穩定性處理 (Numeric Cleaning)

在您的測試結果中，原本應該是  的實部變成了 `3.027e-12`。這是因為 `np.roots` 使用特徵值計算，會有浮點數誤差。

* **解決方案**：我使用了 `round(r, 10)`。這能確保  和  被視為同一個重根「2」。

#### 2. 特徵根與通解的映射邏輯

根據特徵方程  的根，通解的建構邏輯如下：

* **實單根 ()**：對應 。
* **實重根 (,  重)**：對應 。
* **複數根 ()**：
* 在數學上，這對應  與 。
* 根據歐拉公式，我們會將其轉換為實函數形式： 與 。
* **程式處理**：當偵測到虛部不為 0 時，我們會一次消耗掉這對共軛根（放入 `processed_roots`），並同時生成 `cos` 與 `sin` 兩項。



#### 3. 處理複數重根

如測試 (4) 的 ，根為  且各重覆兩次。

* **邏輯**：如果是  重複數根，則需乘上 。
* **結果**：生成 。
